--- a/backend/nids/features.py
+++ b/backend/nids/features.py
@@ -60,11 +60,19 @@ class FeatureExtractor:
     
     def _create_flow_key(self, packet: PacketInfo) -> FlowKey:
-        """Create flow key from packet."""
-        return FlowKey(
-            src_ip=packet.src_ip,
-            dst_ip=packet.dst_ip,
-            src_port=packet.src_port,
-            dst_port=packet.dst_port,
-            protocol=packet.protocol
-        )
+        """Create normalized flow key from packet (bidirectional)."""
+        # Normalize flow key to handle bidirectional traffic
+        # Always put the "smaller" endpoint first for consistency
+        if (packet.src_ip, packet.src_port) < (packet.dst_ip, packet.dst_port):
+            return FlowKey(
+                src_ip=packet.src_ip,
+                dst_ip=packet.dst_ip,
+                src_port=packet.src_port,
+                dst_port=packet.dst_port,
+                protocol=packet.protocol
+            )
+        else:
+            return FlowKey(
+                src_ip=packet.dst_ip,
+                dst_ip=packet.src_ip,
+                src_port=packet.dst_port,
+                dst_port=packet.src_port,
+                protocol=packet.protocol
+            )